<template>
    <div class="page">
        <times :time="time" :show="false"/>
        <div class="area">
            <el-form
                :inline="true"
                :model="formInline"
                class="demo-form-inline"
                label-width="80px"
                size="small"
                label-position="left"
            >
                <el-row>
                    <el-form-item label="区域">
                        <el-select v-model="formInline.provinceId" placeholder="客户所在省份">
                            <el-option label="区域一" value="shanghai"></el-option>
                            <el-option label="区域二" value="beijing"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label>
                        <el-select v-model="formInline.cityId" placeholder="客户所在城市">
                            <el-option label="区域一" value="shanghai"></el-option>
                            <el-option label="区域二" value="beijing"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label>
                        <el-select v-model="formInline.prefectureId" placeholder="客户所在区县">
                            <el-option label="区域一" value="shanghai"></el-option>
                            <el-option label="区域二" value="beijing"></el-option>
                        </el-select>
                    </el-form-item>
                </el-row>
                <el-row>
                    <el-form-item label="业务类型">
                        <el-radio-group v-model="formInline.devType" size="small">
                            <el-radio-button label="备电"></el-radio-button>
                            <el-radio-button label="充电"></el-radio-button>
                            <el-radio-button label="换电"></el-radio-button>
                            <el-radio-button label="售电"></el-radio-button>
                            <el-radio-button label="储能站"></el-radio-button>
                            <el-radio-button label="延寿站"></el-radio-button>
                        </el-radio-group>
                    </el-form-item>
                </el-row>
                <el-row>
                    <el-form-item label="时间">
                        <el-date-picker
                            v-model="srtatendTime"
                            type="datetimerange"
                            range-separator="至"
                            start-placeholder="开始日期"
                            end-placeholder="结束日期"
                        ></el-date-picker>
                    </el-form-item>
                </el-row>
                <el-row></el-row>
                <el-row>
                    <el-form-item label="用户">
                        <el-input v-model="formInline.userTrueName" placeholder="用户名称"></el-input>
                    </el-form-item>
                    <el-form-item label>
                        <el-select v-model="formInline.customerType" placeholder="客户类型">
                            <el-option label="金融机构" value="1"></el-option>
                            <el-option label="医疗卫生" value="2"></el-option>
                            <el-option label="公安交警" value="3"></el-option>
                            <el-option label="学校教育" value="4"></el-option>
                            <el-option label="单位机房" value="5"></el-option>
                            <el-option label="数据中心" value="6"></el-option>
                            <el-option label="物业管理" value="7"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label>
                        <el-input v-model="formInline.address" placeholder="客户地址"></el-input>
                    </el-form-item>
                    <el-form-item label>
                        <el-input v-model="formInline.customerContact" placeholder="客户联系人名称"></el-input>
                    </el-form-item>
                    <el-form-item label>
                        <el-input v-model="formInline.customerServer" placeholder="客户服务人名称"></el-input>
                    </el-form-item>
                </el-row>
                <el-row>
                    <el-button type="primary">查询</el-button>
                </el-row>
            </el-form>
        </div>
        <div class="area" style="margin-top: 20px;padding:20px;">
            <el-row>
                <el-button type="primary" @click="gotoadd">新建</el-button>
            </el-row>
            <el-table
                :data="tableData"
                style="width: 100%;margin-top:10px;"
                height="500"
                :header-cell-style="{background:'#E4EAEC',color:'#666',fontSize:'12px'}"
            >
                <el-table-column prop="userName" label="客户名称" align="center"></el-table-column>
                <el-table-column prop="userTrueName" label="真实姓名" align="center"></el-table-column>
                <el-table-column prop="userIphone" label="客户手机号" align="center"></el-table-column>
                <el-table-column prop="userType" label="客户类型" align="center">
                    <template slot-scope="scope">{{ userType[scope.row.userType]}}</template>
                </el-table-column>
                <el-table-column prop="devType" label="业务类型" align="center">
                    <template slot-scope="scope">{{ tyoecl(scope.row.devType)}}</template>
                </el-table-column>
                <el-table-column prop="address" label="客户地址" align="center"></el-table-column>

                <el-table-column prop="customerContact" label="联系人" align="center"></el-table-column>
                <el-table-column prop="customerServer" label="服务人员" align="center"></el-table-column>
                <el-table-column fixed="right" label="操作" width="100">
                    <template slot-scope="scope">
                        <el-button @click="deletes(scope.row)" type="text" size="small">删除</el-button>
                    </template>
                </el-table-column>
            </el-table>
        </div>
        <el-dialog title="提示" :visible.sync="dialogVisible" width="30%" :before-close="handleClose">
            <span>确定要删除吗？</span>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">取 消</el-button>
                <el-button type="primary" @click="customer_center">确 定</el-button>
            </span>
        </el-dialog>
    </div>
</template>

<script>
import times from "../../../components/tableTime";
import layouts from "../../../components/layouts";
import tablemap from "../../../components/table_map";
import table from "../../../mixins/table";

export default {
    data() {
        return {
            dialogVisible: false,
            time: "",
            srtatendTime: "",
            formInline: {
                provinceId: "",
                cityId: "",
                prefectureId: "",
                devType: "",
                beginTimeString: "",
                endTimeString: "",
                userTrueName: "",
                customerType: "",
                address: "",
                customerContact: "",
                customerServer: ""
            },
            radio: "备电",
            tableData: [],
            devType: {
                "25": "备电客户",
                "19": "充电",
                "22": "储能站",
                "18": "延寿站"
            },
            userType: {
                "0": "个人用户",
                "1": "企业用户"
            }
        };
    },
    mixins: [table],
    components: {
        times,
        layouts,
        tablemap
    },
    created() {
        this.onSubmit();
    },
    mounted() {},
    methods: {
        onSubmit() {
            let vm = this;
            vm.Api.select_customer(vm.formInline).then(res => {
                vm.tableData = res.result;
            });
        },
        gotoadd() {
            this.$router.push({ path: "/customer/add" });
        },
        tyoecl(str) {
            let vm = this;
            return vm.devType[str] || "未知";
        },
        deletes(row) {
            let vm = this;
            vm.dialogVisible = true;
            vm.detId = row.id;
        },
        handleClose(done) {
            done();
        },
        customer_center() {
            let vm = this;
            vm.Api.customer_center_delete(vm.detId).then(res => {
                console.log(res);
                vm.dialogVisible = false;
                vm.$notify({
                    title: "成功",
                    message: "删除成功",
                    type: "success"
                });
                vm.onSubmit();
            });
        }
    }
};
</script>

<style scoped lang='scss'>
.page {
    padding-top: 0.7%;
    width: 1280px;
    min-height: 700px;
    margin: 0 auto;
}
.area {
    background: #fff;
    padding: 20px 0 20px 25px;
}
.line {
    text-align: center;
}
</style>


<style scoped>
</style>
